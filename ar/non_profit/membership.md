## عضوية

يسمح لك نوع مستند العضوية بتسجيل تفاصيل العضوية**للعضو**.

العضوية مصطلح يشير إلى أي منظمة تسمح للأشخاص بالاشتراك ، وغالبًا ما تتطلب منهم دفع رسوم العضوية أو "الاشتراك".

## 1. كيفية إنشاء عضوية

لإنشاء عضوية جديدة ، انتقل إلى:

> غير ربحية> عضوية> جديدة

![العضوية](https://docs.erpnext.com/files/membership.png)

**العضو:**العضو عبارة عن حقل رابط يجلب تفاصيل العضو من نوع مستند العضو.

**حالة العضوية:**حالة العضوية هي حقل محدد يحتوي على جديد ، وحالي ، ومنتهي الصلاحية ، ومعلق ، وملغي. سيتم تحديث حالة انتهاء الصلاحية تلقائيًا عند انتهاء فترة العضوية.

**قسم تفاصيل تاريخ العضوية:**يحتوي هذا القسم على معلومات تتعلق بتاريخ بدء العضوية وتاريخ الانتهاء والعضو منذ تاريخها.

**تفاصيل الدفع:**يحتوي هذا القسم على تفاصيل متعلقة بالدفع. إذا تم وضع علامة على مربع الاختيار الشخص الذي دفع مقابل العضوية المدفوعة على أنه محدد وإلا بدون علامة. يتم جلب المبلغ بناءً على نوع العضوية.

## 2. سمات

## 2.1 إنشاء الفاتورة

إذا حددت _Enable Invoicing_ في إعدادات العضوية ، فسترى زرًا لإنشاء فاتورة مبيعات من نموذج العضوية.

## 3. مدفوعات العضوية باستخدام RazorPay

لدفعات العضوية المتكررة ، يمكنك إعداد اشتراك razorpay للأعضاء. يمكنك العثور على إرشادات حول إعداد razorpay [هنا](https://docs.erpnext.com/docs/v13/user/manual/en/erpnext_integration/razorpay-integration)

> ملاحظة: هذه الميزة متوفرة في الإصدار 13 وما فوق فقط.

يمكنك اتباع الخطوات المذكورة أدناه لإعداد اشتراك Razorpay للعضويات.

1. إعداد RazorPay
2. إعداد تفاصيل الفواتير
3. خطط الإعداد
4. استيراد الأعضاء الحاليين
5. قم بإعداد خطاف ويب RazorPay
6. إعداد موقع الويب

## 3.1 إعدادات العضوية

يمكنك العثور على إرشادات حول إعداد razorpay [هنا](https://docs.erpnext.com/docs/v13/user/manual/en/erpnext_integration/razorpay-integration). يمكنك إعداد الفواتير في إعدادات العضوية في الوحدة النمطية غير الربحية.

![العضوية](https://docs.erpnext.com/files/razorpay-enabled.png)

التحقق من _Enable RazorPay For Memberships_ سيُظهر لك المزيد من خيارات التكوين.

***دورة الفوترة**: هذه هي الفترة الزمنية بين الفواتير. يمكنك إما تحديد الفواتير الشهرية أو السنوية.
***معدل الفوترة**: عدد دورات الفوترة التي يجب أن يتحمل العميل تكاليفها. على سبيل المثال ، إذا كان العميل يشتري عضوية لمدة عام واحد والتي يجب أن يتم إصدار فواتير بها على أساس شهري ، فيجب أن تكون هذه القيمة 12.

![العضوية](https://docs.erpnext.com/files/membership-settings.png)

هناك تكوينات أخرى متاحة للفواتير.

***تمكين الفواتير**: سيؤدي تحديد هذا إلى تمكين إنشاء فواتير للعضويات باستخدام زر**إنشاء فاتورة**.
***إنشاء فاتورة تلقائي لنماذج الويب**: إذا كان لديك إعداد مخصص لنماذج الويب ، فسيؤدي تمكين ذلك إلى إنشاء فاتورة مبيعات تلقائيًا عندما يُصرح بالدفع.
***إجراء إدخال للدفع**: يُنشئ تلقائيًا إدخال دفع لفواتير المبيعات التي تم إنشاؤها من العضوية باستخدام نماذج الويب.

سيسمح لك التحقق من _Enable Invoicing_ بتهيئة الشركة وحساب الخصم لفواتيرك. سيسمح لك فحص**إجراء إدخال الدفع**بتكوين حساب الدفع.

***إرسال إقرار العضوية**: إذا تم تمكين هذا ، فستحصل على خيار لإرسال إقرار بالعضوية إلى العضو بمجرد إنشاء الفاتورة.
***قالب البريد الإلكتروني**: يمكنك تكوين قالب البريد الإلكتروني للإقرار وتعيينه هنا.

إذا تم تمكين _Send عضوية Acknowledgement_ ، فيمكنك تمكين _Send Invoice with Email_ لإرسال الفاتورة مع العضوية. يمكنك أيضًا تكوين تنسيقات الطباعة للعضوية والفاتورة بشكل فردي هنا.

## 3.2 إعداد الخطط

يتوافق نوع العضوية مع خطة RazorPay الخاصة بك. يمكنك قراءة المزيد حول خطة العضوية [هنا](https://docs.erpnext.com/docs/v13/user/manual/en/non_profit/membership_type)

![العضوية](https://docs.erpnext.com/files/plan.png)

عند تنشيط خيارات اشتراك Razorpay ، سترى حقل**معرف الخطة**. هذا هو المكان الذي يمكنك فيه إضافة معرف الخطة من Razorpay.

> ملاحظة: يجب عليك إضافة جميع خططك النشطة وخططك القديمة للحصول على فوترة سلسة.

## 3.3 استيراد الأعضاء

إذا كان لديك أعضاء بالفعل ، فيمكنك استيرادهم باستخدام [أداة استيراد البيانات](https://docs.erpnext.com/docs/v13/user/manual/en/setting-up/data/data-import). إليك [فيديو تعليمي](https://www.youtube.com/watch؟v=WlGD35DM5LI) من نفس الشيء.

تحتاج إلى استيراد أعضاء مع الحقول التالية.

1.**اسم العضو**: الاسم الكامل للعضو
2.**نوع العضوية**: اسم الخطة التي اشتركوا فيها
3.**عنوان البريد الإلكتروني**: معرف البريد الإلكتروني المستخدم لمعاملات Razorpay
4.**معرف الاشتراك**: معرف الاشتراك المقدم من RazorPay
5.**معرف العميل**: معرف الاشتراك المقدم من RazorPay
6.**عضوية PAN**: هذا اختياري

> ملاحظة: سيتم تتبع اشتراكات RazorPay فقط للأعضاء الذين توجد بياناتهم في قائمة الأعضاء.

هكذا سيبدو العضو في ERPNext. ![العضوية](https://docs.erpnext.com/files/member.png)

## 3.4 إعداد webhook

يمكنك إعداد خطاف ويب من لوحة تحكم RazorPay في الإعدادات. يمكنك قراءة المزيد حول الخطافات على الويب في RazorPay [هنا](https://razorpay.com/docs/webhooks/). سيقوم خطاف الويب هذا بإعلام موقع ERPNext الخاص بك متى تم إنشاء اشتراك جديد أو تجديده.

![العضوية](https://docs.erpnext.com/files/razorpay-webhook.png)

ستحتاج إلى التفاصيل التالية لإعداد الويب هوك.

### 3.4.1 عنوان URL للويب هوك

ما يلي هو عنوان URL لموقع ERPNext الخاص بك. هذه هي نقطة النهاية التي ستستخدمها RazorPay لإخطار أي نشاط متعلق بالاشتراك.

""
https: // <your-site> /api/method/erpnext.non_profit.doctype.membership.membership.trigger_razorpay_subscription
""

### 3.4.2 الأحداث

يجب أن تقوم بتمكين حدثين "اشتراك. نشط" و "اشتراك. تكلفة".

### 3.4.3 نشطة

حدد هذا لتمكين الويب هوك

مع هذا ، يتم تنشيط الويب هوك الخاص بك

## 3.5 تفعيل اشتراك جديد من موقع الويب الخاص بك

يمكنك استخدام [التكامل من جانب عميل RazorPay](https://razorpay.com/docs/payments/payment-gateway/web-integration/standard/) لإعداد الدفع على موقعك. للقيام بذلك ، سيتعين عليك أولاً إنشاء أمر اشتراك باستخدام RazorPay يمكنك من خلاله إجراء دفعة.

لإنشاء طلب اشتراك ، يمكنك استخدام نقطة النهاية "create_member_subscription_order" في ERPNext.

يمكنك إرسال طلب POST في نقطة النهاية التالية

""
https: // <your-site> /api/method/erpnext.non_profit.doctype.member.member.create_member_subscription_order
""

الوسيطات التي يتم تمريرها هي قاموس يحتوي على تفاصيل العضو

""
{
    "plan_id": "Foundation Starter" // اسم الخطة كما هو مفصل في نوع العضوية
    "الاسم الكامل": "John Doe"،
    "الجوال": "7506000000"،
    "البريد الإلكتروني": "jane@example.com" ،
    "عموم": "Testing123"
}
""

عند الإنشاء الناجح ، سيتم إنشاء العضو والعميل تلقائيًا. ستعيد نقطة النهاية JSON على النحو التالي.

""
{
    "تفاصيل_الاشتراك": {
        "plan_id": "plan_EXwyxDYDCj3X4v" ،
        "customer_notify": 1
    } ،
    'subscription_id': 'sub_EZycCvXFvqnC6p'
}
""

يمكنك استخدام "معرف_الاشتراك" لبدء الدفع.