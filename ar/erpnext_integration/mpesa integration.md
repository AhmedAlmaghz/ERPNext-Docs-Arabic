\n## تكامل M-Pesa

** يسمح تكامل M-Pesa بمعالجة المعاملات مع مزود بوابة الدفع M-Pesa. **

يعمل تكامل M-Pesa على تسهيل معالجة المدفوعات بين تطبيق M-Pesa و ERPNext. لا يعمل M-Pesa Integration إلا مع نقاط البيع لتسهيل المدفوعات لنفسه. هذه الميزة لا تعمل مع عربة التسوق.

لإعداد M-Pesa ، انتقل إلى:

> عمليات التكامل> المدفوعات> إعدادات M-Pesa

## 1. كيف تحصل على بيانات اعتماد M-Pesa؟

1. لتفعيل بيانات اعتماد API الخاصة بك ، تحتاج إلى تسجيل الدخول إلى حساب M-Pesa الخاص بك.
2. بعد ذلك ، افتح قسم Go Live في التطبيق واتبع الخطوات للحصول على الموافقة على التطبيق.
3. عندما يتم استيفاء جميع حالات الاختبار وتتطابق النتائج المتوقعة مع النتائج النهائية ، يجب عليك إرسال المستند واتباع الخطوات للحصول على بيانات الاعتماد النهائية لتطبيقك.
4. التفاصيل المذكورة في قسم عنوان URL للإنتاج وبيانات الاعتماد هي بيانات الاعتماد التي من المفترض أن تستخدمها في إعدادات M-Pesa.

! [بيانات اعتماد Mpesa] (https://docs.erpnext.com/files/mpesa_credentials.png)

## 2. إعداد M-Pesa

لتمكين M-Pesa Express ، تحتاج إلى تكوين جميع المعلمات الإلزامية التي تلقيتها من M-Pesa. إذا كنت تريد استخدام البيئة المرحلية للتكامل ، فيمكنك تحديد خيار التدريج واستخدام بيانات اعتماد التدريج التي توفرها M-Pesa من خلال إنشاء تطبيق منفصل لنفسه. ! [إعدادات Mpesa] (https://docs.erpnext.com/files/mpesa_settings.png)

عند تمكين تكامل M-Pesa في ERPNext ، سيقوم النظام بإنشاء سجل بوابة الدفع ورئيس الحساب في مخطط الحسابات مع نوع الحساب مثل البنك كما هو موضح في لقطة الشاشة التالية.

! [Mpesa COA] (https://docs.erpnext.com/files/mpesa_coa.png)

! [إعدادات Mpesa POS] (https://docs.erpnext.com/files/mpesa_pos_settings.png)

ستنشئ أيضًا طريقة دفع تحمل نفس الاسم والحساب لبوابة الدفع ، إلى جانب حقول مخصصة معينة في إعدادات نقاط البيع للتعامل مع مدفوعات نقاط البيع.

! [حساب بوابة الدفع] (https://docs.erpnext.com/files/payment_gateway_account_mpesa.png)

بعد تكوين حساب Payment Gateway ، ستتمكن من قبول المدفوعات عبر الإنترنت عبر M-Pesa.

## 3 \. مدفوعات M-Pesa POS

عند إعداد ملف تعريف POS باستخدام وضع الدفع M-Pesa ، ستعرض عملية الدفع في نقاط البيع قسم معلومات إضافية. يحتوي هذا القسم على حقلين تم إعدادهما تلقائيًا عند إضافة إعدادات M-Pesa.

! [معلومات إضافية عن نقاط البيع] (https://docs.erpnext.com/files/additional-information.png)

بمجرد أن يملأ مستخدم نقطة البيع رقم الهاتف المحمول للعميل ، يمكنه بدء طلب الدفع من العميل. يتم إرسال طلب إلى تطبيق الهاتف المحمول الخاص بالعميل M-Pesa المرتبط برقم الهاتف المحمول المحدد. بمجرد معالجة المستخدم للدفع ، تتم مطالبة المستخدم من خلال مربع حوار تأكيد بإرسال الدفع.

## 4 \. رصيد حساب M-Pesa

يمكن جلب رصيد الحساب المرتبط بـ M-Pesa فردي عبر زر الحصول على رصيد الحساب. سيؤدي هذا إلى تحميل تفاصيل رصيد حساب M-Pesa في لوحة القيادة.

! [رصيد حساب نقاط البيع] (https://docs.erpnext.com/files/mpesa_account_balance.png)

## 5 \. دعم عملات المعاملات

ستعمل M-Pesa فقط مع الشركة التي لديها KSH (شلن كيني) كعملة للشركة.