\n\n## إعداد LDAP

بروتوكول الوصول الخفيف إلى الدليل (LDAP) هو نظام مركزي للتحكم في الوصول تستخدمه العديد من المؤسسات الصغيرة والمتوسطة الحجم.

من خلال إعدادات خدمة LDAP ، يمكنك تسجيل الدخول إلى حساب ERPNext باستخدام بيانات اعتماد LDAP.

## 1 \. المتطلبات الأساسية

لاستخدام LDAP ، ستحتاج أولاً إلى تثبيت وحدة Python `ldap3`. للقيام بذلك ، افتح جلسة طرفية على الخادم الذي يستضيف مثيل ERPNext. اذهب إلى دليل "فرابي-مقاعد البدلاء". قم بتشغيل الأمر: `./env/pip install ldap3`

أنت الآن جاهز لتمكين خدمة LDAP في ERPNext.

## 2 \. إعداد LDAP

لإعداد LDAP ، انتقل إلى

> الصفحة الرئيسية> عمليات التكامل> إعدادات LDAP

العديد من المعلمات إلزامية للسماح لـ ERPNext بالاتصال بـ LDAP. هم:

* عنوان URL لخادم LDAP: هذا هو عنوان URL لخادم LDAP. يجب أن يكون بصيغة `ldap: // yourserver: port` أو` ldaps: // yourserver: port`
    
* الاسم المميز الأساسي (DN): هذا هو الاسم المميز للمستخدم الذي لديه أذونات للبحث عن تفاصيل المستخدم على خادم LDAP الخاص بك. يجب أن يكون هذا مستخدمًا لديه أذونات للقراءة فقط على خادم LDAP.
    
* كلمة المرور لـ Base DN: هذه هي كلمة المرور للمستخدم أعلاه ، والتي تُستخدم للبحث عن تفاصيل المستخدم على خادم LDAP.
    
* الوحدة التنظيمية للمستخدمين: هذا هو الاسم المميز للوحدة التنظيمية الذي يجب أن يكون جميع المستخدمين في خادم LDAP جزءًا منه ليتمكنوا من تسجيل الدخول إلى ERPNext.
    
* الدور الافتراضي عند الإنشاء: عندما يتم إنشاء المستخدم في ERPNext ، سيتم تعيينه بهذا الدور الافتراضي ، في المرة الأولى التي يسجلون فيها الدخول.
    
* سلسلة بحث LDAP: يسمح هذا الحقل لـ ERPNext بمطابقة المستخدم / البريد الإلكتروني الذي تم إدخاله في شاشة تسجيل الدخول إلى ERPNext ، مع خادم LDAP. على سبيل المثال ، يمكنك استخدام عنوان البريد الإلكتروني أو اسم المستخدم حسب تفضيلاتك.
    
    يجب إدخاله بالتنسيق: `LDAPFIELD = {0}`
    
    مثال على اسم مستخدم Active Directory: `sAMAccountName = {0}`
    
    افتح مثال اسم مستخدم LDAP: `uid = {0}`
    
* حقل البريد الإلكتروني لـ LDAP: يحدد حقل LDAP الذي يحتوي على عنوان البريد الإلكتروني للمستخدم.
    
    مثال على Active Directory و Open LDAP: "mail"
    
* حقل اسم مستخدم LDAP: يحدد حقل LDAP الذي يحتوي على اسم المستخدم للمستخدم.
    
    مثال على Active Directory: `sAMAccountName`
    
    افتح مثال LDAP: `uid`
    
* حقل الاسم الأول لـ LDAP: يحدد حقل LDAP الذي يحتوي على الاسم الأول للمستخدم.
    
    مثال على Active Directory: `GivenName`
    
    افتح مثال LDAP: `sn`
    

هناك العديد من الحقول الأخرى غير الإلزامية التي يمكنك استخدامها لتعيين حقول مستخدم LDAP إلى حقول مستخدم ERPNext. هم:

*   الاسم الأوسط
*   هاتف
*   متحرك

بمجرد أن تكون إعداداتك صحيحة ، يمكنك النقر فوق مربع الاختيار "ممكّن" في الأعلى. عند محاولة تمكين LDAP ، سيحاول ERPNext الاتصال بخادم LDAP للتأكد من صحة الإعدادات. إذا فشل ، فلن تكون قادرًا على تمكين LDAP وستتلقى رسالة خطأ.

ستشير رسالة الخطأ إلى المشكلة التي تحتاج إلى حل للمتابعة.

بعد ضبط تمكين LDAP ، على شاشة تسجيل الدخول ، يتيح النظام خيار ** تسجيل الدخول عبر LDAP **.

### 2.1 أمان LDAP

في قسم أمان LDAP ، لديك العديد من الخيارات للاتصال الآمن بخادم LDAP.

* ##### وضع SSL / TLS
    
    يحدِّد ما إذا كنت تريد بدء جلسة TLS عند الاتصال الأولي بخادم LDAP.
    
* ##### طلب شهادة موثوق بها
    
    يحدد ما إذا كنت تطلب شهادة موثوقة للاتصال بخادم LDAP
    
    إذا كنت تحدد شهادة موثوقة ، فستحتاج إلى تحديد المسارات إلى ملفات الشهادة الخاصة بك. يجب وضع هذه الملفات على خادم ERPNext ، ويجب أن تكون الحقول التالية مسارًا مطلقًا للملفات الموجودة على الخادم الخاص بك. حقول الشهادة هي:
    
* المسار إلى ملف المفتاح الخاص
    
* المسار إلى شهادة الخادم
    
* المسار إلى ملف شهادات CA
    

### 2.2 تعيينات مجموعة LDAP

يتيح لك ERPNext أيضًا تعيين مجموعات LDAP متعددة تلقائيًا لأدوار ERPNext المناسبة. على سبيل المثال ، قد ترغب في أن يكون لجميع موظفي المحاسبة لديك دور مستخدم الحسابات تلقائيًا.

تأكد من ملء حقل مجموعة LDAP للسماح بذلك. هذا هو حقل LDAP الموجود في كائن مستخدم في LDAP ، والذي يحتوي على جميع المجموعات التي يكون المستخدم عضوًا فيها.

بالنسبة لـ Active Directory و LDAP المفتوح ، يجب تعيين هذا الحقل على "memberOf".

قد يحتاج LDAP المفتوح إلى تمكين هذا الحقل على خادم LDAP. يرجى الاطلاع على الأمثلة على الإنترنت لمزيد من التفاصيل.

> لاحظ أنه سيتم فحص جميع أدوار ERPNext في كل مرة يسجل فيها المستخدم الدخول وستتم إزالته أو إضافته إلى أذونات المستخدم.

في منطقة إعدادات LDAP ، توجد قائمتان منسدلتان. 1. وضع SSL / TLS - اضبط هذا على ** StartTLS ** للاتصال بخادم LDAP باستخدام StartTLS. إذا كان خادم LDAP لا يدعم StartTLS ، فسيؤدي تعيين هذا على StartTLS إلى ظهور خطأ "StartTLS غير مدعوم". تحقق من التكوين على خادم LDAP إذا تلقيت هذا الخطأ. 2. طلب ​​شهادة موثوقة - إذا قمت بتغيير هذا إلى ** نعم ** ، فيجب أن تكون الشهادة المقدمة من خادم LDAP موثوقة من قبل خادم Frappe / ERPNext. إذا كنت تفضل استخدام StartTLS بشهادة موقعة ذاتيًا (غير موثوق بها) ، فاضبط هذا على ** لا **. إذا كنت لا تستخدم StartTLS ، فسيتم تجاهل هذا الإعداد.