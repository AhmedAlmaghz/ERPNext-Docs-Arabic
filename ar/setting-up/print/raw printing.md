## طباعة خام

> مقدمة في الإصدار 12

**يُطلق على إرسال سلسلة من الأوامر إلى الطابعة مباشرةً بلغتها الأصلية اسم الطباعة الأولية.**

تحتاج العديد من الطابعات الحرارية إلى إرسال هذه الأوامر الأولية إليهم من أجل أداء وظائف مثل طباعة الرمز الشريطي وطباعة الإيصالات وطباعة الملصقات وما إلى ذلك. تتجاوز الطباعة الأولية برامج تشغيل الطابعة في معظم الحالات ، مما يجعلها سريعة وموثوقة للغاية. يمكن لـ Raw Printing أيضًا القيام ببعض الميزات المتقدمة مثل قطع ورق الإيصالات ، وطرد الأدراج النقدية ، وما إلى ذلك.

## 1. إعداد الطباعة الأولية في ERPNext

### 1.1 تثبيت تطبيق QZ Tray على كمبيوتر العميل

قم بتنزيل وتثبيت تطبيق QZ Tray على الكمبيوتر الذي تتصل به الطابعة الحرارية. يمكن العثور على هذا التطبيق في [الموقع الرسمي] الخاص به (https://qz.io/download/). حاليًا ، يتم دعم Windows و macOS و Linux بواسطة QZ Tray. أثناء التثبيت ، سيُطلب منك تثبيت Java إذا لم تكن مثبتة بالفعل ، يرجى تثبيت Java لإكمال التثبيت.

يمكن الحصول على مزيد من الإرشادات حول تثبيت تطبيق QZ Tray [هنا](https://qz.io/wiki/using-qz-tray).

### 1.2 إنشاء تنسيق طباعة أوامر أولية

لتتمكن من إرسال أوامر أولية إلى طابعة ، عليك أولاً إنشاء تنسيق طباعة بأوامر خام. تُستخدم لغة قوالب Jinja في الأوامر الأولية تمامًا كما هو الحال في [تنسيق طباعة HTML المخصص](https://docs.erpnext.com/docs/v13/user/manual/en/customize-erpnext/print-format).

لإنشاء تنسيق طباعة جديد لـ Raw Printing:

1. انتقل إلى قائمة تنسيق الطباعة:**الصفحة الرئيسية> الإعدادات> الطباعة> تنسيق الطباعة**
2. انقر فوق جديد.
3. حدد DocType ذي الصلة.
4. تحقق من خيارات**التنسيق المخصص**و**الطباعة الأولية**.
5. املأ حقل**أوامر أولية**بالأوامر الأولية المطلوبة لإرسالها إلى الطابعة.
6. انقر فوق حفظ.
    
    ![تنسيق طباعة أوامر أولية](https://docs.erpnext.com/files/raw-command-print-format.png)
    

حاليًا ، يمكن استخدام أي لغة طابعة قائمة على السلسلة في حقل "أوامر أولية" في تنسيق الطباعة. تتطلب كتابة الأوامر الأولية معرفة اللغة الأصلية للطابعة التي توفرها الشركة المصنعة للطابعة. يرجى الرجوع إلى دليل المطور المقدم من قبل الشركة المصنعة للطابعة حول كيفية كتابة أوامرهم الأصلية.

### 1.3 تمكين الطباعة الأولية في إعداد الطباعة

لتمكين الطباعة الأولية:

1. انتقل إلى:**الصفحة الرئيسية> الإعدادات> الطباعة> إعدادات الطباعة> الطباعة الأولية**.
2. حدد الخيار**تمكين الطباعة الأولية**.
3. حفظ.

## 2. طرق الاستفادة من الطباعة الأولية في ERPNext

توجد طريقتان لإرسال أوامر Raw Printing إلى طابعتك.

### 2.1 النقر فوق طباعة في صفحة عرض الطباعة

لطباعة تنسيق طباعة أمر خام من طريقة عرض طباعة المستند:

1. حدد تنسيق الطباعة المناسب. بالنسبة لتنسيق الطباعة في Raw Commands ، تظهر رسالة "لا توجد معاينة متاحة" بدلاً من معاينة الطباعة.
2. انقر على زر الطباعة.
3. يُرجى السماح بمطالبة الاتصال من علبة QZ بالإجراءات التي بدأتها (اختصار لوحة المفاتيح: Alt + A).
    *![موجه علبة QZ](https://docs.erpnext.com/files/qz-tray-prompt.png)
4. قد يُطلب منك تحديد "تنسيق الطباعة - تعيين الطابعة".
    
    * يُستخدم هذا التعيين لإرسال أوامر الطباعة إلى الطابعة المناسبة.
    * يجب تثبيت الطابعة على جهاز الكمبيوتر الخاص بك لتتمكن من تعيينها إلى تنسيق طباعة. ![تنسيق الطباعة - تعيين الطابعة](https://docs.erpnext.com/files/printer-settings.png)
    * يتم تخزين هذا التعيين محليًا على نفس الكمبيوتر وسيتعين تعيينه على كل جهاز عميل.
    * يمكنك أيضًا تعديل هذا بالنقر فوق الزر**إعدادات الطابعة**.
        
        ![طباعة أولية من عرض الطباعة](https://docs.erpnext.com/files/raw-printing-from-print-view.gif)
        

### 2.2 استدعاء وظائف Raw Print من برنامج نصي للعميل

غالبًا ما يكون من المطلوب إصدار أمر طباعة في حدث معين (مثل الإرسال والحفظ والتعديل وما إلى ذلك). من الممكن كتابة [برنامج نصي للعميل](https://docs.erpnext.com/docs/v13/user/manual/en/customize-erpnext/client-scripts) للقيام بذلك نيابة عنك.

فيما يلي وظائف Raw Print ذات الصلة:

1. الوظيفة: `frappe.ui.form.qz_connect`
    * غلاف اتصال لإنشاء اتصال مع تطبيق QZ Tray.
    * إرجاع الوعد الذي يقرر إنشاء اتصال ناجح.
    * يسمح للاتصالات النشطة وغير النشطة بحل بغض النظر. ومن ثم يمكن استدعائه في كل مرة قبل إرسال الأمر.
    * مثال على الاستخدام:

""
    frappe.ui.form.qz_connect ()
    .then (function () {
        إرجاع qz.print (التكوين ، البيانات) ؛
    })
    ثم (frappe.ui.form.qz_success)
    .catch (يخطئ => {
        frappe.ui.form.qz_fail (يخطئ) ،
    }) ؛
""

هنا ، `qz` هو كائن عام توفره مكتبة` qz-tray.js`.

2. الوظيفة: `frappe.ui.form.qz_get_printer_list`
    
    * يمنحك قائمة الطابعات المتاحة لتطبيق QZ Tray
    * إرجاع الوعد الذي ينتهي إلى قائمة الطابعات
    
    مثال على الاستخدام:
    

""
     frappe.ui.form.qz_get_printer_list (). ثم (
           // الإجراء المطلوب للحصول على قائمة الطابعات.
           // ملاحظة: قائمة الطابعة عبارة عن مجموعة من السلاسل.
      ) ؛
""

3. الوظيفة: `frappe.ui.form.qz_success`
    
    * يعرض رسالة "تم إرسال الطباعة إلى الطابعة!" تنبيه للمستخدم. يمكن استدعاؤه بعد نجاح أمر الطباعة.
4. الوظيفة: `frappe.ui.form.qz_fail`
    
    * يعرض رسالة الخطأ للمستخدم. يجب أن يتم استدعاؤه عند فشل اتصال علبة QZ.

يمكنك أيضًا الوصول مباشرةً إلى الوظائف التي توفرها مكتبة `qz-tray.js` عبر الكائن` qz`. [انقر هنا للحصول على وثائق مكتبة qz-tray.js](https://qz.io/api/). ملاحظة: تتم تهيئة الكائن `qz` فقط بعد استدعاء` frappe.ui.form.qz_connect` لأول مرة. في حالة طلب الكائن `qz` قبل ذلك ، يمكنك استخدام` frappe.ui.form.qz_init`.

1. [إعدادات الطباعة](https://docs.erpnext.com/docs/v13/user/manual/en/setting-up/print/print-settings)
2. [تنسيق الطباعة](https://docs.erpnext.com/docs/v13/user/manual/en/setting-up/print/print-format)
3. [نمط الطباعة](https://docs.erpnext.com/docs/v13/user/manual/en/setting-up/print/print-style)