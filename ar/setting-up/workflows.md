## سير العمل

**باستخدام مهام سير العمل ، يمكنك إعادة كتابة كيفية الموافقة على عملية / سير عمل معين في ERPNext.**

يمكنك تعيين مستويات متعددة من الموافقة لسير عمل ERPNext. للسماح للعديد من الأشخاص بإرسال طلبات متعددة ، للحصول على موافقات من عدة مستخدمين ، يتطلب منك ERPNext ملء شروط سير العمل. يتتبع ERPNext الأذونات المتعددة قبل الإرسال.

ضع في اعتبارك سيناريو ، حيث يلزم وجود مستويات متعددة من الموافقة لعرض الأسعار. سيقوم مندوب المبيعات (المستخدم الذي يتولى دور "مستخدم المبيعات") بإنشاء عرض أسعار. ثم يتم الموافقة عليها أو رفضها من قبل مسؤول المبيعات (مستخدم له دور "مدير المبيعات"). إذا تمت الموافقة عليه من قبل مسؤول المبيعات ، فسيتم اعتماده أو رفضه من قِبل المدير الإقليمي (مستخدم له دور "المدير الإقليمي").

لإنشاء قواعد سير العمل والانتقال ، انتقل إلى:

> الصفحة الرئيسية> الإعدادات> سير العمل

بمجرد إنشاء سير العمل ، يمكنك اتخاذ إجراءات بشأنه من خلال [إجراءات سير العمل](https://docs.erpnext.com/docs/v13/user/manual/en/setting-up/workflow-actions).

## 1. المتطلبات الأساسية

قبل إنشاء سير عمل ، يُنصح بإنشاء ما يلي أولاً:

* [إجراءات سير العمل](https://docs.erpnext.com/docs/v13/user/manual/en/setting-up/workflow-actions)
* حالات سير العمل مثل الموافقة ، الملغاة ، إلخ.

## 2. كيفية إنشاء سير العمل

1. اذهب إلى قائمة سير العمل ، وانقر على جديد.
2. أدخل اسمًا لـ**Workflow**وحدد DocType الذي سيتم تطبيقه عليه.
3. أدخل الحالات المختلفة لسير العمل. أدخل حالة المستند لهم ، وحدد الحقل المراد تحديثه من عمود تحديث الحقل ، وأدخل القيمة التي سيتم تحديثها ضمن قيمة التحديث.
    
    يمكن أن يكون لحالات سير العمل ألوان مختلفة حسب الولاية. على سبيل المثال: الأخضر للنجاح. حالات المستند: تم الحفظ = 0 ، تم الإرسال = 1 ، ملغى = 2.
    
    ![Workflow](https://docs.erpnext.com/files/workflow.png)
    
4. أدخل قواعد الانتقال.
    
    ![قواعد نقل سير العمل](https://docs.erpnext.com/files/workflow-transition-rules.png)
    

### 2.2 أشياء يجب ملاحظتها عند إنشاء سير العمل

* يؤدي إنشاء سير عمل في ERPNext بشكل أساسي إلى تجاوز سير عمل "الحفظ والإرسال" العادي. وبالتالي ، سيعمل المستند بناءً على سير العمل الخاص بك وليس بناءً على سير عمل الكود المحدد مسبقًا. ومن ثم قد لا يكون هناك زر / خيار إرسال إذا لم تحدده في سير العمل الذي تقوم بإنشائه.
    
    إذا لم تقم بتطبيق سير عمل على مستند ، وكان هذا المستند قابلاً للإرسال ، فحينئذٍ يتضمن سير العمل الافتراضي بالحالات: مسودة - تم الإرسال - تم إلغاؤها. إذا كنت تقوم بتطبيق سير عمل على مستند قابل للإرسال ، فيجب أن يتعامل المستخدم مع هذه الحالات الافتراضية.
    
* لا يمكن إلغاء مستند ما لم يتم تقديمه.
    
* إذا كنت ترغب في منح خيار الإلغاء ، فسيتعين عليك كتابة خطوة انتقال سير العمل التي تنص على أنه من المرسل يمكنك الإلغاء.
    
* إذا لم يتم تحديث الحقول الموجودة ضمن عمود تحديث الحقل ، فسيتم إنشاء حقل مخصص جديد بالاسم الذي قمت بتعيينه في الحقل "حقل حالة سير العمل".
    

### 2.3 خيارات أخرى لسير العمل

1. نشط: عند تحديد هذا الخيار ، تصبح جميع مهام سير العمل الأخرى لـ DocType المحدد غير نشطة.
2. عدم تجاوز الحالة: لن تتجاوز حالة سير العمل حالة المستند (عرض الأسعار) في عرض القائمة.
3. إرسال تنبيهات البريد الإلكتروني: سيتم إرسال رسائل البريد الإلكتروني إلى المستخدم بإجراءات سير العمل المحتملة التالية.

## 3. سمات

### 3.1 تمكين / تعطيل حالة سير العمل الاختيارية

> مقدمة في الإصدار 12

في الولايات ، تعني حالة سير العمل الاختيارية أن الولاية قد لا تكون جزءًا من الموافقة النهائية.

على سبيل المثال يمكن أن تكون حالات مثل "ملغاة" أو "مرفوضة" اختيارية. ![حالة اختيارية](https://docs.erpnext.com/files/workflow-optional-state.png)

**ملاحظة:**لا يتم إنشاء إجراءات سير العمل للحالات الاختيارية.

### 3.2 الشروط

يمكنك أيضًا إضافة شرط ليكون الانتقال قابلاً للتطبيق. على سبيل المثال ، في هذه الحالة ، إذا قام مسؤول المبيعات بإنشاء عرض أسعار بإجمالي إجمالي قدره 100000 دولار أمريكي أو أكثر ، فيجب أن يوافق دور معين. لكي يحدث هذا في انتقال معين ، يمكنك تعيين خاصية لـ**Condition**:

""
doc.grand_total <= 100000
""

هنا ، "grand_total" هو اسم الحقل الخاص بالحقل "الإجمالي الكلي" لعرض الأسعار. لرؤية اسم الحقل الخاص بالحقل ، اذهب إلى قائمة> تخصيص.

يمكن أن يمتد هذا إلى أي خاصية للوثيقة.

> مقدمة في الإصدار 13

في الإصدار 13 ، يمكنك استخدام وظائف التاريخ / الوقت والجلسة و get_value و get_list في تعبيرات الشرط.

الوظائف المسموح بها:

* frappe.db.get \ _value
* frappe.db.get \ _list
* جلسة فرابيه
* frappe.utils.now \ _datetime
* frappe.utils.get \ _datetime
* frappe.utils.add_to_date
* frappe.utils.now

أمثلة:

""
doc.creation> frappe.utils.add_to_date (frappe.utils.now_datetime () ، الأيام = -5 ، as_string = True ، as_datetime = True)
""

## 4. مثال على عملية الموافقة على عرض الأسعار

عندما يقوم مستخدم المبيعات بحفظ عرض أسعار ، تتغير حالة المستند إلى "مسودة" وعند النقر فوق إرسال تغييرات الحالة إلى "موافقة معلقة من قبل مدير المبيعات":

![حالة سير العمل في المعاملة](https://docs.erpnext.com/files/workflow-status-in-transaction.png)

عندما يقوم مدير المبيعات بتسجيل الدخول ، يمكنه إما الموافقة أو الرفض. في حالة الموافقة ، تتغير حالة المستند إلى "موافقة معلقة بواسطة المدير الإقليمي".

![خيارات إجراءات سير العمل](https://docs.erpnext.com/files/workflow-action-options.png)

عندما يفتح المدير الإقليمي عرض الأسعار ، يمكنه في النهاية "الموافقة" أو "الرفض".

![خيارات إجراءات سير العمل](https://docs.erpnext.com/files/workflow-action-options-2.png)

## 5. فيديو

1. [إجراءات سير العمل](https://docs.erpnext.com/docs/v13/user/manual/en/setting-up/workflow-actions)
2. [قاعدة التنازل](https://docs.erpnext.com/docs/v13/user/manual/en/automation/assignment-rule)