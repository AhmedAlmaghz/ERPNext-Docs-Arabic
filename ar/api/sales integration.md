\n## تكامل دورة المبيعات

الأساليب والتدفقات القياسية في القائمة البيضاء لدمج نظام إدارة الطلبات الخارجية ودورة المبيعات باستخدام REST API

### 1 \. طلب المبيعات

ينشئ Frappe Framework [REST API] (https://frappeframework.com/docs/v14/user/en/api/rest) لجميع أنواع DocTypes خارج الصندوق. يمكن استخدام هذا الأسلوب لإنشاء المستند الأول لدورة المبيعات. في حال كنت تبدأ بأمر المبيعات ، يمكنك استخدام طلب REST API POST القياسي لإنشاء الطلب. يظهر مثال أدناه ، يمكنك تضمين الحقول المخصصة وتفاصيل نوع المستند الأخرى في النص وفقًا لذلك.

""
POST / api / Resource / أمر المبيعات

# جسم
{
    "DOCTYPE": "أمر المبيعات" ،
    "العميل": "اختبار العميل" ،
    "company_address": "اختبار - الفواتير"،
    "customer_address": "Test-Billing-3"،
    "أغراض": [{
        "item_code": "عرض الجوال"،
        "الكمية": 10 ،
        "المعدل": 2000 ،
        "تاريخ_التسليم": "2022-11-06"،
        "delivery_warehouse": "المتاجر - GTPL"
    }]
}
""

### 2 \. مذكرة تسليم

في حال كنت تبدأ بإشعار التسليم ، استخدم نفس الطريقة الموضحة أعلاه لأمر المبيعات ، ما عليك سوى استبدال قيمة مفتاح نوع المستند بـ ** إشعار التسليم ** بدلاً من ** أمر المبيعات **. في حالة رغبتك في عمل إشعار تسليم من أمر مبيعات ، استخدم نقطة النهاية أدناه. المعلمة `source_name` هنا هي معرف طلب المبيعات.

""
نشر /api/method/erpnext.selling.doctype.sales_order.sales_order.make_delivery_note

# جسم
{"source_name": "SO-2022-00001"}
""

تقوم نقطة النهاية بإرجاع كائن JSON لملاحظة التسليم كاستجابة مع جميع العناصر المعلقة في الترتيب ليتم تسليمها.

### 3 \. فاتورة المبيعات

مرة أخرى ، إذا كنت تقوم فقط بعمل فاتورة مبيعات ، فإن أفضل طريقة هي استخدام واجهة برمجة تطبيقات REST القياسية. لهذا يرجى الرجوع إلى المثال المذكور في قسم طلب المبيعات.

لعمل فاتورة مبيعات من طلب مبيعات ، استخدم نقطة النهاية المذكورة أدناه. المعلمة `source_name` هنا هي معرف طلب المبيعات.

""
نشر /api/method/erpnext.selling.doctype.sales_order.sales_order.make_sales_invoice

# جسم
{"source_name": "SO-2022-00001"}
""

لعمل فاتورة مبيعات من مذكرة التسليم ، استخدم نقطة النهاية المذكورة أدناه. المعلمة `source_name` هنا هي معرف إشعار التسليم.

""
نشر /api/method/erpnext.stock.doctype.delivery_note.delivery_note.make_sales_invoice

# جسم
{"source_name": "SO-2022-00001"}

""

تقوم كل من Enpoints بإرجاع عنصر JSON فاتورة المبيعات مع جميع العناصر المعلقة التي سيتم تحرير فواتير بها.

### 4 \. الدفع مقابل الطلب أو الفاتورة

لإنشاء إدخال دفع مقابل طلب مبيعات أو فاتورة ، استخدم نقطة النهاية أدناه

""
نشر /api/method/erpnext.accounts.doctype.payment_entry.payment_entry.get_payment_entry

# جسم
{
    "dt": "فاتورة المبيعات"،
    "dn": "SI-2022-0001"،
    "party_amount": 2000 ، # تمرير إذا كان المستند لا يحتوي على حقل "المبلغ_المعلق" (معلمة اختيارية)
    "bank_account": "Bank Name - CAB" ، # Pass هي حالة تريد استخدامها بخلاف المعلمة الافتراضية (معلمة اختيارية)
    "bank_amount": 2000 ، # المبلغ المدفوع أو المستلم اعتمادًا على نوع إدخال الدفع (معلمة اختيارية)
    "party_type": "Customer" ، # إذا كان إدخال الدفع ضد نوع طرف آخر غير العميل أو المورد (معلمة اختيارية)
    "payment_type": "الدفع" ، # الدفع أو الاستلام (معلمة اختيارية)

}
""